<span>-- @path Class=</span><del style="background:#ffe6e6;">/class2table/metamodels/Class.ecore&para;<br>-- @path Relational=/class2table/metamodels/Relational.ecore&para;<br>&para;<br>&para;<br>-- MUTATION "Iterator Modification" from reject to collect (line 32:16-32:92 of original transformation)&para;<br>-- MUTATION "Collection Operation Call Modification" from union to sum (line 43:11-43:70 of original transformation)&para;<br>-- MUTATION "InPattern Element Modification" from a:Attribute to a:Package (line 76:3-76:22 of original transformation)&para;<br>-- MUTATION "Binding-target Modification" from type to name (line 119:4-119:59 of original transformation)&para;<br>-- MUTATION "OutPattern Element Modification" from out:Type to out:Schema (line 57:3-59:4 of original transformation)&para;<br>-- MUTATION "Argument Type Modification" from oclIsKindOf:Class to oclIsKindOf:Package (line 32:38-32:64 of original transformation)&para;<br>-- MUTATION "Navigation Modification" from c.att to c.supers (line 43:33-43:38 of original transformation)&para;<br>-- MUTATION "Operation Call Modification" from oclIsKindOf to startsWith (line 105:4-105:35 of original transformation)&para;<br>&para;<br>&para;<br>&para;<br>&para;<br>&para;<br>&para;<br>&para;<br>&para;<br>&para;<br>-- inheritance not supported yet</del><ins style="background:#e6ffe6;">C:\Users\varaminz\Downloads\Project\workspaceTEST34\anatlyzer.atl.tests.api\trafo\Class.ecore&para;<br>-- @path Relational=C:\Users\varaminz\Downloads\Project\workspaceTEST34\anatlyzer.atl.tests.api\trafo\Relational.ecore&para;<br>module Class2Relational;&para;<br>create OUT : Relational from IN : Class;&para;<br></ins><span>&para;<br>helper context Class!NamedElt def: name : String =&para;<br>if self.name.oclIsUndefined() then&para;<br>''&para;<br>else&para;<br>self.name&para;<br>endif;&para;<br>&para;<br>helper context Class!Attribute def: multiValued : Boolean =&para;<br>if self.multiValued.oclIsUndefined() then&para;<br>false&para;<br>else&para;<br>self.multiValued&para;<br>endif;&para;<br>&para;<br>helper def: defaultType : String =&para;<br>'Integer';&para;<br>&para;<br>helper def: objectIdType(idType : String) : Class!DataType =&para;<br>Class!DataType.allInstances()-&gt;any(e |&para;<br>e.name = idType&para;<br>);&para;<br>&para;<br>rule Package2Schema {&para;<br>from&para;<br>p : Class!Package&para;<br>to&para;<br>s : Relational!Schema (&para;<br>tables &lt;- p.elems-&gt;select(e |&para;<br>e.oclIsKindOf(Class!</span><del style="background:#ffe6e6;">Package</del><ins style="background:#e6ffe6;">Class</ins><span>)&para;<br>)-&gt;</span><del style="background:#ffe6e6;">coll</del><ins style="background:#e6ffe6;">rej</ins><span>ect(e |&para;<br>e.isAbstract&para;<br>),&para;<br>types &lt;- p.elems-&gt;select(e |&para;<br>e.oclIsKindOf(Class!DataType)&para;<br>)&para;<br>)&para;<br>}&para;<br>&para;<br>rule Class2Table {&para;<br>from&para;<br>c : Class!Class&para;<br>(&para;<br>not c.isAbstract&para;<br>)&para;<br>to&para;<br>out : Relational!Table (&para;<br>name &lt;- c.name,&para;<br>col &lt;- Sequence {key}-&gt;</span><del style="background:#ffe6e6;">sum(c.supers</del><ins style="background:#e6ffe6;">union(c.att</ins><span>-&gt;select(e |&para;<br>not e.multiValued&para;<br>)),&para;<br>key &lt;- Set {key}&para;<br>),&para;<br>key : Relational!Column (&para;<br>name &lt;- 'objectId',&para;<br>type &lt;- thisModule.objectIdType(thisModule.defaultType)&para;<br>)&para;<br>}&para;<br>&para;<br>rule DataType2Type {&para;<br>from&para;<br>dt : Class!DataType&para;<br>to&para;<br>out : Relational!</span><del style="background:#ffe6e6;">Schema</del><ins style="background:#e6ffe6;">Type</ins><span> (&para;<br>name &lt;- dt.name&para;<br>)&para;<br>}&para;<br>&para;<br>rule DataTypeAttribute2Column {&para;<br>from&para;<br>a : Class!Attribute&para;<br>(&para;<br>a.type.oclIsKindOf(Class!DataType) and not a.multiValued&para;<br>)&para;<br>to&para;<br>out : Relational!Column (&para;<br>name &lt;- a.name,&para;<br>type &lt;- a.type&para;<br>)&para;<br>}&para;<br>&para;<br>rule MultiValuedDataTypeAttribute2Column {&para;<br>from&para;<br>a : Class!</span><del style="background:#ffe6e6;">Packag</del><ins style="background:#e6ffe6;">Attribut</ins><span>e&para;<br>(&para;<br>a.type.oclIsKindOf(Class!DataType) and a.multiValued&para;<br>)&para;<br>to&para;<br>out : Relational!Table (&para;<br>name &lt;- a.owner.name + '_' + a.name,&para;<br>col &lt;- Sequence {thisModule.createIdColumn(a.owner), value}&para;<br>),&para;<br>value : Relational!Column (&para;<br>name &lt;- a.name,&para;<br>type &lt;- a.type&para;<br>)&para;<br>}&para;<br>&para;<br>rule ClassAttribute2Column {&para;<br>from&para;<br>a : Class!Attribute&para;<br>(&para;<br>a.type.oclIsKindOf(Class!Class) and not a.multiValued&para;<br>)&para;<br>to&para;<br>foreignKey : Relational!Column (&para;<br>name &lt;- a.name + 'Id',&para;<br>type &lt;- thisModule.objectIdType(thisModule.defaultType)&para;<br>)&para;<br>}&para;<br>&para;<br>rule MultiValuedClassAttribute2Column {&para;<br>from&para;<br>a : Class!Attribute&para;<br>(&para;<br>a.type.</span><del style="background:#ffe6e6;">startsWith</del><ins style="background:#e6ffe6;">oclIsKindOf</ins><span>(Class!Class) and a.multiValued&para;<br>)&para;<br>to&para;<br>t : Relational!Table (&para;<br>name &lt;- a.owner.name + '_' + a.name,&para;<br>col &lt;- Sequence {thisModule.createIdColumn(a.owner), thisModule.createIdColumn(a)}&para;<br>)&para;<br>}&para;<br>&para;<br>lazy rule createIdColumn {&para;<br>from&para;<br>ne : Class!NamedElt&para;<br>to&para;<br>key : Relational!Column (&para;<br>name &lt;- ne.name,&para;<br></span><del style="background:#ffe6e6;">nam</del><ins style="background:#e6ffe6;">typ</ins><span>e &lt;- thisModule.objectIdType(thisModule.defaultType)&para;<br>)&para;<br>}&para;<br></span><ins style="background:#e6ffe6;">&para;<br>-- MUTATION "Argument Type Modification" from oclIsKindOf:Package to oclIsKindOf:Class (line 34:1-34:29 of original transformation)&para;<br>&para;<br>&para;<br>-- MUTATION "Iterator Modification" from collect to reject (line 33:11-37:2 of original transformation)&para;<br>&para;<br>&para;<br>-- MUTATION "Navigation Modification" from c.supers to c.att (line 53:28-53:36 of original transformation)&para;<br>&para;<br>&para;<br>-- MUTATION "Operation Call Modification" from startsWith to oclIsKindOf (line 120:1-120:31 of original transformation)&para;<br>&para;<br>&para;<br>-- MUTATION "Collection Operation Call Modification" from sum to union (line 53:8-55:3 of original transformation)&para;<br>&para;<br>&para;<br>-- MUTATION "Binding-target Modification" from name to type (line 135:1-135:56 of original transformation)&para;<br>&para;<br>&para;<br>-- MUTATION "InPattern Element Modification" from a:Package to a:Attribute (line 88:1-88:18 of original transformation)&para;<br>&para;<br>&para;<br>-- MUTATION "OutPattern Element Modification" from out:Schema to out:Type (line 68:1-70:2 of original transformation)&para;<br>&para;<br></ins>